# keras自带高级API

## keras　内置很多函数对训练环节的编写

## 以下是对上面四个步骤的列子

## compile 制订了 优化器的选择，损失函数的悬着，以及损失函数的计算和确定

network.compile\(optimizer = optimizers.Adam\(lr=0.01\),  
loss = tf.losses.CategoricalCrossentropy\(from\_logits =True\), metrics=\['accuracy'\] \)

network.fit\(db, epochs=10\) \#这个确定数据集是db,这个数据集一个迭代10次

## evaluate 测试用的

## 一般测试是一个周期测试一次，或者模型训练好了在进行测试

## 以下是测试代码

network.compile\(optimizer = optimizers.Adam\(lr=0.01\),  
loss = tf.losses.CategoricalCrossentropy\(from\_logits =True\), metrices=\['accuracy'\]\)

## validation\_data指定测试集， validation\_freq=2 表示循环2次，进行一次测试

network.fit\(db, epochs =10,validation\_data = ds\_val, validation\_freq =2\) \#这种train\_test是在训练中间进行的

## z这种测试是在train中间执行的

network.evaluate\(ds\_val\)

## 当模型的参数已经训练好了

## 手写

sample = next\(iter\(ds\_val\)\) x = sample\[0\] y = sample\[1\] \# one-hot pred = network.predict\(x\) \# \[b,10\]

## convert back to number

y = tf.argmax\(y, axis =1\) pred = tf.argmax\(pred, axis =1\)

print\(pred\) print\(y\)

## BUild a meter

acc\_meter = metrics.Accuracy\(\) loss\_meter = metrics.Mean\(\)

## updata data

loss\_meter.update\_state\(loss\) acc\_meter.update\_state\(y, pred\)

## Get Average data

print\(step, 'loss', loss\_meter.result\(\).numpy\(\)\)

print\(step, 'Eveluate Acc:', total\_correct/total, acc\_meter.result\(\).numpy\(\)\)

## .result\(\)-&gt;tensor tenor use.numpy\(\)-&gt;numpy

## Clear buffer

if step%100 == 0: print\(step, 'loss:', losss\_meter.result\(\).numpy\(\)\) loss\_meter.reset\_states\(\)

if step %500 == 0: total, total\_correct = 0. , 0 acc\_meter.reset\_states\(\)

